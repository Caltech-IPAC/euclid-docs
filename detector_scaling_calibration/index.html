<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Science goals for SIR Detector Scaling &mdash; SIR_DetectorScalingCalibration August-2025 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/documentation_options.js?v=c780cd6e"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="SIR_DetectorScalingCalibration" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="#" class="icon icon-home"> SIR_DetectorScalingCalibration
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Code Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">SIR_DetectorScalingCalibration</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">SIR_DetectorScalingCalibration</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Science goals for SIR Detector Scaling</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="science-goals-for-sir-detector-scaling">
<h1>Science goals for SIR Detector Scaling<a class="headerlink" href="#science-goals-for-sir-detector-scaling" title="Link to this heading"></a></h1>
<p>SIR Detector Scaling has two components - a calibration module and an apply module. In totality, the goal is to apply a multiplicative correction to the detector response to a uniform illumination. The correction is applied and tailored to each detector. This correction attempts to reduce detector-dependent variations on different spatial scales including:</p>
<ol class="loweralpha simple">
<li><p>Pixel-to-pixel variations resulting from intrinsic QE differences across each detector</p></li>
<li><p>Small scale (~ 100 px) QE variations due to repeatable structures in the background detector response which are present at the few percent level in localized areas on each detector.  These “void” structures are very repeatable and relate to missing epoxy layers in the manufacture of the H2RG detectors.</p></li>
<li><p>Large scales QE corrections (&gt; 100 px, up to detector scale), to account for detector-scale intrinsic gradients in the response of the detector to uniform light. The magnitude of these variations are generally small (&lt; 1-2%) and vary from one detector to another.</p></li>
</ol>
<p>This specific documentation handles only the calibration module, appropriately named as SIR_DetectorScalingCalibration, where the calibration product is generated. In the apply module, this calibration product is applied. For the apply module, please visit <a class="reference external" href="https://caltech-ipac.github.io/euclid-docs/detector_scaling_apply/">https://caltech-ipac.github.io/euclid-docs/detector_scaling_apply/</a></p>
</section>
<section id="documentation-for-sir-detectorscalingcalibration-calibration-module">
<h1>Documentation for SIR DetectorScalingCalibration (calibration module)<a class="headerlink" href="#documentation-for-sir-detectorscalingcalibration-calibration-module" title="Link to this heading"></a></h1>
<p>In this document, you will find the documentation for Euclid’s SIR DetectorScalingCalibration module
as well as documentation for the underlying Python classes. This module derives a pixel-wise multiplication correction factor to the detector response to a uniform illumination and is tailored to each detector. This multiplication factor, generated as a 2D map, is needed as input by the SIR DetectorScaling (apply) module under SIR Pipeline.</p>
</section>
<section id="module-usage">
<h1>Module Usage<a class="headerlink" href="#module-usage" title="Link to this heading"></a></h1>
<p>The full details of the latest command-line usage documentation can always be found, using the command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>E-Run<span class="w"> </span>SIR_Calibration<span class="w"> </span>SIR_DetectorScalingCalibration<span class="w"> </span>--help
</pre></div>
</div>
<p>In summary, the most important command-line switches and arguments, when running the module in stand-alone mode, are:</p>
<section id="inputs-and-outputs">
<h2>Inputs and Outputs<a class="headerlink" href="#inputs-and-outputs" title="Link to this heading"></a></h2>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">--workdir</span> <span class="pre">WORKDIR</span></code></dt><dd><p>The root working directory where all of the files are located.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">--config</span> <span class="pre">CONFIG</span></code></dt><dd><p>The name of the configuration file, relative to the <code class="docutils literal notranslate"><span class="pre">workdir</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">--logdir</span> <span class="pre">LOGDIR</span></code></dt><dd><p>The name of the logging directory, relative to the <code class="docutils literal notranslate"><span class="pre">workdir</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">--mdb</span> <span class="pre">MDB</span></code></dt><dd><p>The Mission Database XML file, containing all key instrument and mission parameters, relative to the <code class="docutils literal notranslate"><span class="pre">workdir</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">--outfile</span> <span class="pre">OUTPUT</span></code></dt><dd><p>The name of the output FITS file, containing 2D weighted QE maps, for all 16 detectors, for both RGS and BGS grisms, relative to
the <code class="docutils literal notranslate"><span class="pre">workdir</span></code>.</p>
</dd>
</dl>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Code Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">SIR_DetectorScalingCalibration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="SIR_DetectorScalingCalibration.html">SIR_DetectorScalingCalibration package</a></li>
</ul>
</li>
</ul>
</div>
</section>
</section>
<section id="flatmaker-api">
<h1>FlatMaker API<a class="headerlink" href="#flatmaker-api" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="SIR_DetectorScalingCalibration.FlatMaker.FlatMaker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FlatMaker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grism_parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qe_files_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qe_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SIR_DetectorScalingCalibration/FlatMaker.html#FlatMaker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SIR_DetectorScalingCalibration.FlatMaker.FlatMaker" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Creates weighted 2D QE maps, per detetor, from 3D
(wavelength dependent) input QE maps</p>
<dl class="py method">
<dt class="sig sig-object py" id="SIR_DetectorScalingCalibration.FlatMaker.FlatMaker.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grism_parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qe_files_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qe_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SIR_DetectorScalingCalibration/FlatMaker.html#FlatMaker.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SIR_DetectorScalingCalibration.FlatMaker.FlatMaker.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize a FlatMaker instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_dir</strong> (<em>str</em>) – Directory containing the QE FITS files.</p></li>
<li><p><strong>grism_parameters</strong> (<em>dict</em>) – <p>Per-grism configuration with required keys ‘alpha’ and ‘hdu_extn’, e.g.:
{ ‘RGS’: {‘alpha’: -0.9, ‘hdu_extn’: ‘RGS000_ORDER_1’},</p>
<blockquote>
<div><p>’BGS’: {‘alpha’: -0.75, ‘hdu_extn’: ‘BGS000_ORDER_1’} }</p>
</div></blockquote>
</p></li>
<li><p><strong>qe_files_list</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – Filenames of QE FITS cubes located under <cite>data_dir</cite>.
The first entry is used to load the wavelength grid.</p></li>
<li><p><strong>qe_range</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – QE cutoff bounds provided as (max_qe, min_qe) in this order.
Pixels with QE outside [min_qe, max_qe] at any wavelength are masked.</p></li>
<li><p><strong>logger</strong> (<em>ElementsKernel.Logging</em>) – Logger used to report messages and progress.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SIR_DetectorScalingCalibration.FlatMaker.FlatMaker._load_wavelengths">
<span class="sig-name descname"><span class="pre">_load_wavelengths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qe_file_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SIR_DetectorScalingCalibration/FlatMaker.html#FlatMaker._load_wavelengths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SIR_DetectorScalingCalibration.FlatMaker.FlatMaker._load_wavelengths" title="Link to this definition"></a></dt>
<dd><p>Load the wavelength grid from a QE FITS cube.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>qe_file_path</strong> (<em>str</em>) – Full path to the QE FITS file.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Reads the ‘WAVELEN’ header from each image HDU (skipping the
primary HDU) and populates <cite>self._wave</cite> with the wavelength grid.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SIR_DetectorScalingCalibration.FlatMaker.FlatMaker._get_wavelength_range">
<span class="sig-name descname"><span class="pre">_get_wavelength_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wavelengths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transmissions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SIR_DetectorScalingCalibration/FlatMaker.html#FlatMaker._get_wavelength_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SIR_DetectorScalingCalibration.FlatMaker.FlatMaker._get_wavelength_range" title="Link to this definition"></a></dt>
<dd><p>Determine indices on the internal wavelength grid where transmission is significant.</p>
<p>Selects the wavelength interval on the input transmission curve where
throughput exceeds 10% of its maximum, then maps that interval onto
<cite>self._wave</cite> and returns the inclusive start/end indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavelengths</strong> (<em>np.ndarray</em>) – Wavelengths for the provided transmission curve.</p></li>
<li><p><strong>transmissions</strong> (<em>np.ndarray</em>) – Transmission values corresponding to <cite>wavelengths</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>index_start</strong> (<em>int</em>) – Inclusive start index into <cite>self._wave</cite> for the selected interval.</p></li>
<li><p><strong>index_end</strong> (<em>int</em>) – Inclusive end index into <cite>self._wave</cite> for the selected interval.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SIR_DetectorScalingCalibration.FlatMaker.FlatMaker.load_grism_transmission_curves">
<span class="sig-name descname"><span class="pre">load_grism_transmission_curves</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grism_file_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SIR_DetectorScalingCalibration/FlatMaker.html#FlatMaker.load_grism_transmission_curves"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SIR_DetectorScalingCalibration.FlatMaker.FlatMaker.load_grism_transmission_curves" title="Link to this definition"></a></dt>
<dd><p>Interpolate NISP grism transmission curves and compute per-grism weights.</p>
<p>Reads transmission data from the FITS extensions specified in
<cite>grism_parameters[‘hdu_extn’]</cite>.</p>
<p>Determines the useful wavelength interval via <cite>_get_wavelength_range()</cite>
(throughput &gt; 10% of max), maps that interval onto <cite>self._wave</cite>,
interpolates transmission to this internal grid using cubic interpolation,
and computes weights with <cite>_calculate_weights()</cite> using the corresponding <cite>alpha</cite>.</p>
<p>Populates <cite>self._wavelength_ranges[grism]</cite>, <cite>self._wavelengths[grism]</cite>,
and <cite>self._weights[grism]</cite> for each grism.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>grism_file_path</strong> (<em>str</em>) – Full path to the NISP grism transmission FITS file.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SIR_DetectorScalingCalibration.FlatMaker.FlatMaker._calculate_weights">
<span class="sig-name descname"><span class="pre">_calculate_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wavelengths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transmissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SIR_DetectorScalingCalibration/FlatMaker.html#FlatMaker._calculate_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SIR_DetectorScalingCalibration.FlatMaker.FlatMaker._calculate_weights" title="Link to this definition"></a></dt>
<dd><p>Compute normalized weights per wavelength based on zodiacal-light photon flux.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavelengths</strong> (<em>np.ndarray</em>) – Wavelengths on the internal grid for the selected grism.</p></li>
<li><p><strong>transmissions</strong> (<em>np.ndarray</em>) – Transmission values corresponding to <cite>wavelengths</cite>.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – a constant (see Notes below for more)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>weights</strong> – Normalized weights (sum to 1) for each wavelength.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uses <cite>alpha</cite> to model median zodiacal spectrum intensity: I_nu ~ lambda^alpha.</p></li>
<li><p>Delta nu varies with wavelength; approximately 2.4 at 12,500, decreasing to</p></li>
</ul>
<p>~1.12 toward the red end.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SIR_DetectorScalingCalibration.FlatMaker.FlatMaker._check_delta_nu">
<span class="sig-name descname"><span class="pre">_check_delta_nu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wavelengths</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SIR_DetectorScalingCalibration/FlatMaker.html#FlatMaker._check_delta_nu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SIR_DetectorScalingCalibration.FlatMaker.FlatMaker._check_delta_nu" title="Link to this definition"></a></dt>
<dd><blockquote>
<div><p>Compute Δν across the wavelength grid via Nyquist sampling.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>wavelengths</strong> (<em>np.ndarray</em><em> of </em><em>floats</em>) – requisite range of wavelengths</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li></li>
<li><p><strong>delta_nu</strong> (<em>np.ndarray of floats</em>) – change in nu values interpolated for <cite>wavelengths</cite></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><cite>resolution</cite> is Nyquist sampled</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SIR_DetectorScalingCalibration.FlatMaker.FlatMaker._get_detid_scaid_qefilename_dict">
<span class="sig-name descname"><span class="pre">_get_detid_scaid_qefilename_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SIR_DetectorScalingCalibration/FlatMaker.html#FlatMaker._get_detid_scaid_qefilename_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SIR_DetectorScalingCalibration.FlatMaker.FlatMaker._get_detid_scaid_qefilename_dict" title="Link to this definition"></a></dt>
<dd><p>Create a mapping from detector ID to SCA ID and QE filename.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_dir</strong> (<em>str</em>) – data directory where QE input FITS files are located</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>detid_scaid_qefilename_dict</strong> – Mapping {detector_id: [sca_id (str), qe_filename (str)]}.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict[str, list]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SIR_DetectorScalingCalibration.FlatMaker.FlatMaker._get_mask">
<span class="sig-name descname"><span class="pre">_get_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grism</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qe_filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SIR_DetectorScalingCalibration/FlatMaker.html#FlatMaker._get_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SIR_DetectorScalingCalibration.FlatMaker.FlatMaker._get_mask" title="Link to this definition"></a></dt>
<dd><p>Create a boolean mask of valid pixels across all wavelengths.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grism</strong> (<em>str</em>) – grism color - BGS or RGS</p></li>
<li><p><strong>qe_filepath</strong> (<em>str</em>) – full path for a detector’s QE input file</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li></li>
<li><p><strong>mask</strong> (<em>np.ndarray</em>) – boolean array of shape ((2040, 2040), dtype=bool) of all pixels within
acceptable QE range (self._qe_lo, self._qe_hi) for all wavelengths</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>A pixel is dubbed as “bad” at ALL wavelengths, as soon as its QE value
is found to be outside the inclusive range [self._qe_lo, self._qe_hi]
for any single wavelength. That pixel is subsequently thrown out of
the mask.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SIR_DetectorScalingCalibration.FlatMaker.FlatMaker.write_fits">
<span class="sig-name descname"><span class="pre">write_fits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_fits_filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_history</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SIR_DetectorScalingCalibration/FlatMaker.html#FlatMaker.write_fits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SIR_DetectorScalingCalibration.FlatMaker.FlatMaker.write_fits" title="Link to this definition"></a></dt>
<dd><p>Write flat-fielded QE maps into grism-specific FITS files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_dir</strong> (<em>str</em>) – Directory for input QE maps FITS files</p></li>
<li><p><strong>output_fits_filepath</strong> (<em>str</em>) – output FITS filepath</p></li>
<li><p><strong>text_history</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – line-by-line text, as List, to describe the history</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li></li>
<li><p><em>None</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="example-run">
<h1>Example Run<a class="headerlink" href="#example-run" title="Link to this heading"></a></h1>
<p>An example run can be submitted with the following command,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>E-Run<span class="w"> </span>SIR_Calibration<span class="w"> </span>CreateDetectorScalingFile<span class="w"> </span>--workdir<span class="w"> </span>/stage/euclid-staff-idas/dev-SIR/Ranga-project-data/data_all<span class="w"> </span>--outfile<span class="w"> </span>test_resources<span class="w"> </span>--mdb<span class="w"> </span>input/EUC_MDB_MISSIONCONFIGURATION_DEV_2023-12-15-1.xml
</pre></div>
</div>
</section>
<section id="uml-diagrams">
<h1>UML Diagrams<a class="headerlink" href="#uml-diagrams" title="Link to this heading"></a></h1>
<p>TODO: Put a summary of the UML diagrams.</p>
</section>
<section id="index">
<h1>Index<a class="headerlink" href="#index" title="Link to this heading"></a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
</ul>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-right" title="SIR_DetectorScalingCalibration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Indrajit Das, Phil Appleton, Nathaniel R. Stickley, Ranga-Ram Chary.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>